{"remainingRequest":"/Users/andreabrioschi/Desktop/progetto TLW/push-notification-app/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/andreabrioschi/Desktop/progetto TLW/push-notification-app/src/components/TokensList.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/andreabrioschi/Desktop/progetto TLW/push-notification-app/src/components/TokensList.vue","mtime":1626254860739},{"path":"/Users/andreabrioschi/Desktop/progetto TLW/push-notification-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/andreabrioschi/Desktop/progetto TLW/push-notification-app/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/andreabrioschi/Desktop/progetto TLW/push-notification-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/andreabrioschi/Desktop/progetto TLW/push-notification-app/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiVG9rZW5zTGlzdCIsCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHRva2VuczogW10sCiAgICAgIGxvYWRpbmc6IHRydWUsCiAgICAgIHNlYXJjaDogIiIsCiAgICAgIGVycm9yOiBudWxsLAogICAgICBjb21wb25lbnRLZXk6IDAsCiAgICB9OwogIH0sCiAgYXN5bmMgY3JlYXRlZCgpIHsKICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gYXdhaXQgdGhpcy4kYXV0aC5nZXRUb2tlblNpbGVudGx5KCk7CiAgICB0cnkgewogICAgICBjb25zdCB7IGRhdGEgfSA9IGF3YWl0IHRoaXMuJGh0dHAuZ2V0KAogICAgICAgICJodHRwczovL3B1c2gtYXBpLmhlcm9rdWFwcC5jb20vdG9rZW5zIiwKICAgICAgICB7CiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHthY2Nlc3NUb2tlbn1gLAogICAgICAgICAgfSwKICAgICAgICB9CiAgICAgICk7CiAgICAgIHRoaXMudG9rZW5zID0gZGF0YVsicmVzcG9uc2UiXTsKICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgICB0aGlzLmVycm9yID0gZTsKICAgICAgY29uc29sZS5lcnJvcihlKTsKICAgICAgLy8gICB0aGlzLmFwaU1lc3NhZ2UgPSBgRXJyb3I6IHRoZSBzZXJ2ZXIgcmVzcG9uZGVkIHdpdGggJyR7ZS5yZXNwb25zZS5zdGF0dXN9OiAke2UucmVzcG9uc2Uuc3RhdHVzVGV4dH0nYDsKICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICBmaWx0ZXJlZExpc3QoKSB7CiAgICAgIHJldHVybiB0aGlzLnRva2Vucy5maWx0ZXIoKHRva2VuKSA9PiB7CiAgICAgICAgcmV0dXJuIHRva2VuLmN1c3RvbWVyX2lkX3RyYWNlCiAgICAgICAgICAudG9Mb3dlckNhc2UoKQogICAgICAgICAgLmluY2x1ZGVzKHRoaXMuc2VhcmNoLnRvTG93ZXJDYXNlKCkpOwogICAgICB9KTsKICAgIH0sCiAgfSwKICBtZXRob2RzOiB7CiAgICBhc3luYyBkZWxldGVUb2tlbihpZCkgewogICAgICBpZiAoCiAgICAgICAgY29uZmlybSgKICAgICAgICAgICJDYW5jZWxsYXJlIGlsIHRva2VuP1xuTm9uIHNhcsOgIHBvc3NpYmlsZSByZWN1cGVyYXJsbyBpbiBzZWd1aXRvIgogICAgICAgICkKICAgICAgKSB7CiAgICAgICAgY29uc3QgYWNjZXNzVG9rZW4gPSBhd2FpdCB0aGlzLiRhdXRoLmdldFRva2VuU2lsZW50bHkoKTsKICAgICAgICB0cnkgewogICAgICAgICAgYXdhaXQgdGhpcy4kaHR0cC5kZWxldGUoCiAgICAgICAgICAgICJodHRwczovL3B1c2gtYXBpLmhlcm9rdWFwcC5jb20vdG9rZW5zLyIgKyBpZCwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHthY2Nlc3NUb2tlbn1gLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0KICAgICAgICAgICk7CiAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgY29uc29sZS5lcnJvcihlKTsKICAgICAgICAgIC8vICAgdGhpcy5hcGlNZXNzYWdlID0gYEVycm9yOiB0aGUgc2VydmVyIHJlc3BvbmRlZCB3aXRoICcke2UucmVzcG9uc2Uuc3RhdHVzfTogJHtlLnJlc3BvbnNlLnN0YXR1c1RleHR9J2A7CiAgICAgICAgfQogICAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzLnRva2VucykgewogICAgICAgICAgaWYgKHRoaXMudG9rZW5zW2tleV1bImlkIl0gPT09IGlkKSB7CiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnRva2Vuc1trZXldOwogICAgICAgICAgICB0aGlzLmZvcmNlUmVyZW5kZXIoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdGhpcy5zZWFyY2ggPSAiICI7CiAgICAgICAgdGhpcy5zZWFyY2ggPSAiIjsKICAgICAgfQogICAgfSwKICAgIGZvcmNlUmVyZW5kZXIoKSB7CiAgICAgIHRoaXMuY29tcG9uZW50S2V5ICs9IDE7CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["TokensList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"TokensList.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div id=\"TokensList\" :key=\"componentKey\">\n    <input\n      type=\"search\"\n      v-model=\"search\"\n      class=\"form-control\"\n      placeholder=\"Id del cliente..\"\n    />\n    <div v-if=\"loading\" class=\"text-center pt-5\">\n      <h5>Caricamento lista token</h5>\n      <div class=\"spinner-grow text-secondary\" role=\"status\">\n        <span class=\"sr-only\">Loading...</span>\n      </div>\n    </div>\n    <div v-if=\"error\"></div>\n    <div class=\"card-group\">\n      <div\n        class=\"card border shadow rounded\"\n        v-for=\"token of filteredList\"\n        :key=\"token.id\"\n        style=\"min-width: 18rem; margin: 10px\"\n      >\n        <div class=\"card-body d-flex flex-column justify-content-between\">\n          <div class=\"d-flex justify-content-between\">\n            <h5 class=\"card-title\">{{ token.id }}</h5>\n            <font-awesome-icon\n              icon=\"times\"\n              @click=\"deleteToken(token.id)\"\n              class=\"text-danger pointer\"\n            >\n            </font-awesome-icon>\n          </div>\n\n          <p class=\"card-text\">\n            {{ token.token }}\n          </p>\n          <div class=\"d-flex justify-content-between\">\n            <router-link :to=\"'/tokens/edit/' + token.id\" class=\"card-link\"\n              >Modifica</router-link\n            >\n            <router-link\n              :to=\"'/tokens/notification/' + token.id\"\n              class=\"card-link btn btn-primary btn-sm\"\n              >Invia Notifica\n              <font-awesome-icon icon=\"chevron-right\" class=\"ml-1\">\n              </font-awesome-icon\n            ></router-link>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"TokensList\",\n  data() {\n    return {\n      tokens: [],\n      loading: true,\n      search: \"\",\n      error: null,\n      componentKey: 0,\n    };\n  },\n  async created() {\n    const accessToken = await this.$auth.getTokenSilently();\n    try {\n      const { data } = await this.$http.get(\n        \"https://push-api.herokuapp.com/tokens\",\n        {\n          headers: {\n            Authorization: `Bearer ${accessToken}`,\n          },\n        }\n      );\n      this.tokens = data[\"response\"];\n      this.loading = false;\n    } catch (e) {\n      this.loading = false;\n      this.error = e;\n      console.error(e);\n      //   this.apiMessage = `Error: the server responded with '${e.response.status}: ${e.response.statusText}'`;\n    }\n  },\n  computed: {\n    filteredList() {\n      return this.tokens.filter((token) => {\n        return token.customer_id_trace\n          .toLowerCase()\n          .includes(this.search.toLowerCase());\n      });\n    },\n  },\n  methods: {\n    async deleteToken(id) {\n      if (\n        confirm(\n          \"Cancellare il token?\\nNon sar√† possibile recuperarlo in seguito\"\n        )\n      ) {\n        const accessToken = await this.$auth.getTokenSilently();\n        try {\n          await this.$http.delete(\n            \"https://push-api.herokuapp.com/tokens/\" + id,\n            {\n              headers: {\n                Authorization: `Bearer ${accessToken}`,\n              },\n            }\n          );\n        } catch (e) {\n          console.error(e);\n          //   this.apiMessage = `Error: the server responded with '${e.response.status}: ${e.response.statusText}'`;\n        }\n        for (var key in this.tokens) {\n          if (this.tokens[key][\"id\"] === id) {\n            delete this.tokens[key];\n            this.forceRerender();\n          }\n        }\n        this.search = \" \";\n        this.search = \"\";\n      }\n    },\n    forceRerender() {\n      this.componentKey += 1;\n    },\n  },\n};\n</script>\n"]}]}